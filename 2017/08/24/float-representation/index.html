<!DOCTYPE html>
<html>

<head>
  <meta charset="utf-8">
  
  <title>Float representation in C++ | Xi He</title>
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
  <meta name="description" content="The third test is wired. What happed on earth when computing float number a, why it could return the correct result even the first part of computations makes the result to 0?
1234567891011121314151617">
<meta property="og:type" content="article">
<meta property="og:title" content="Float representation in C++">
<meta property="og:url" content="http://xihey.com/2017/08/24/float-representation/index.html">
<meta property="og:site_name" content="Xi He">
<meta property="og:description" content="The third test is wired. What happed on earth when computing float number a, why it could return the correct result even the first part of computations makes the result to 0?
1234567891011121314151617">
<meta property="og:updated_time" content="2017-08-29T12:09:54.000Z">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="Float representation in C++">
<meta name="twitter:description" content="The third test is wired. What happed on earth when computing float number a, why it could return the correct result even the first part of computations makes the result to 0?
1234567891011121314151617">
  
  
    <link rel="icon" href="/favicon.ico">
    <!--<link rel="icon" href="favicon.ico">-->
     <!--<link href="/favicon.ico" rel="icon" type="image/x-ico">-->
  
  <link rel="stylesheet" href="/css/style.css" type="text/css">
  
<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-66373249-1', 'auto');
  ga('send', 'pageview');

</script>
  
</head>
<body>
  <div id="container">
    <div class="left-col">
    <div class="overlay"></div>
<div class="intrude-less">
	<header id="header" class="inner">
		<a href="/intro" class="profilepic">
			
			<img lazy-src="https://imagizer.imageshack.us/v2/535x535q90/923/Pt63aa.jpg" class="js-avatar">
			
		</a>

		<hgroup>
		  <h1 class="header-author"><a href="/archives">Xi He</a></h1>
		</hgroup>

		
		<p class="header-subtitle">Make it clear</p>
		

		
			<div class="switch-btn">
				<div class="icon">
					<div class="icon-ctn">
						<div class="icon-wrap icon-house" data-idx="0">
							<div class="birdhouse"></div>
							<div class="birdhouse_holes"></div>
						</div>
						<div class="icon-wrap icon-ribbon hide" data-idx="1">
							<div class="ribbon"></div>
						</div>
						
						<div class="icon-wrap icon-link hide" data-idx="2">
							<div class="loopback_l"></div>
							<div class="loopback_r"></div>
						</div>
						
                                                    
					</div>
					
				</div>
				<div class="tips-box hide">
					<div class="tips-arrow"></div>
					<ul class="tips-inner">
						<li>Home</li>
						<li>Tags</li>
						
						<li>Links</li>
						
						
					</ul>
				</div>
			</div>
		

		<div class="switch-area">
			<div class="switch-wrap">
				<section class="switch-part switch-part1">
					<nav class="header-menu">
						<ul>
						
							<li><a href="/intro">About me</a></li>
				        
							<li><a href="/works">Works</a></li>
				        
							<li><a href="/news">News</a></li>
				        
							<li><a href="/CV">CV</a></li>
				        
						</ul>
					</nav>
					<nav class="header-nav">
						<div class="social">
							
								<a class="github" target="_blank" href="https://github.com/heeryerate" title="github">github</a>
					        
								<a class="linkedin" target="_blank" href="https://www.linkedin.com/profile/edit-picture-info?trk=hp-identity-camera-icon&_l=en_US" title="linkedin">linkedin</a>
					        
								<a class="facebook" target="_blank" href="https://www.facebook.com/heerye" title="facebook">facebook</a>
					        
								<a class="mail" target="_blank" href="mailto:xih314@lehigh.edu" title="mail">mail</a>
					        
						</div>
					</nav>
				</section>
				
				
				<section class="switch-part switch-part2">
					<div class="widget tagcloud" id="js-tagcloud">
						<a href="/tags/Editor/" style="font-size: 10px;">Editor</a> <a href="/tags/Hexo/" style="font-size: 20px;">Hexo</a> <a href="/tags/Linux/" style="font-size: 10px;">Linux</a> <a href="/tags/c/" style="font-size: 10px;">c++</a> <a href="/tags/python/" style="font-size: 20px;">python</a>
					</div>
				</section>
				
				
				
				<section class="switch-part switch-part3">
					<div id="js-friends">
					
			          <a target="_blank" class="main-nav-link switch-friends-link" href="http://mtakac.com/">Martin Takac</a><br>
			        
			          <a target="_blank" class="main-nav-link switch-friends-link" href="http://optml.lehigh.edu/">OptML</a><br>
			        
			          <a target="_blank" class="main-nav-link switch-friends-link" href="https://ise.lehigh.edu/">ISE</a><br>
			        
			          <a target="_blank" class="main-nav-link switch-friends-link" href="http://www1.lehigh.edu/">Lehigh</a><br>
			        
			        </div>
				</section>
				

                                
			</div>
		</div>
        <script type="text/javascript" src="http://counter8.freecounter.ovh/private/counter.js?c=7d044c354ea4ce48c23087b4cfef7a74"></script>
	</header>				
</div>
    </div>
    <div class="mid-col">
      <nav id="mobile-nav">
  	<div class="overlay">
  		<div class="slider-trigger"></div>
  		<h1 class="header-author js-mobile-header hide">Xi He</h1>
  	</div>
	<div class="intrude-less">
		<header id="header" class="inner">
			<div class="profilepic">
				<img lazy-src="https://imagizer.imageshack.us/v2/535x535q90/923/Pt63aa.jpg" class="js-avatar">
			</div>
			<hgroup>
			  <h1 class="header-author">Xi He</h1>
			</hgroup>
			
			<p class="header-subtitle">Make it clear</p>
			
			<nav class="header-menu">
				<ul>
				
					<li><a href="/intro">About me</a></li>
		        
					<li><a href="/works">Works</a></li>
		        
					<li><a href="/news">News</a></li>
		        
					<li><a href="/CV">CV</a></li>
		        
		        <div class="clearfix"></div>
				</ul>
			</nav>
			<nav class="header-nav">
				<div class="social">
					
						<a class="github" target="_blank" href="https://github.com/heeryerate" title="github">github</a>
			        
						<a class="linkedin" target="_blank" href="https://www.linkedin.com/profile/edit-picture-info?trk=hp-identity-camera-icon&_l=en_US" title="linkedin">linkedin</a>
			        
						<a class="facebook" target="_blank" href="https://www.facebook.com/heerye" title="facebook">facebook</a>
			        
						<a class="mail" target="_blank" href="mailto:xih314@lehigh.edu" title="mail">mail</a>
			        
				</div>
			</nav>
		</header>				
	</div>
</nav>
      <div class="body-wrap"><article id="post-float-representation" class="article article-type-post" itemscope itemprop="blogPost">
  
    <div class="article-meta">
      <a href="/2017/08/24/float-representation/" class="article-date">
  	<time datetime="2017-08-24T18:07:46.000Z" itemprop="datePublished">2017-08-24</time>
</a>
    </div>
  
  <div class="article-inner">
    
      <input type="hidden" class="isFancy" />
    
    
      <header class="article-header">
        
  
    <h1 class="article-title" itemprop="name">
      Float representation in C++
    </h1>
  

      </header>
      
      <div class="article-info article-info-post">
        
	<div class="article-tag tagcloud">
		<ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/c/">c++</a></li></ul>
	</div>

        
	<div class="article-category tagcloud">
	<a class="article-category-link" href="/categories/programming/">programming<span class="article-category-count">2</span></a>
	</div>


        <div class="clearfix"></div>
      </div>
      
    
    <div class="article-entry" itemprop="articleBody">
      
        <p>The third test is wired. What happed on earth when computing <code>float</code> number <code>a</code>, why it could return the correct result even the first part of computations makes the result to <code>0</code>?</p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line"><span class="preprocessor">#<span class="keyword">include</span> <span class="string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="preprocessor">#<span class="keyword">include</span> <span class="string">&lt;bitset&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="comment">// test 1</span></span><br><span class="line">    <span class="comment">// int a = 0;</span></span><br><span class="line">    <span class="comment">// int b = 0;</span></span><br><span class="line">    <span class="comment">// cout &lt;&lt; &amp;a &lt;&lt; endl;</span></span><br><span class="line">    <span class="comment">// cout &lt;&lt; &amp;b &lt;&lt; endl;</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="comment">// test 2</span></span><br><span class="line">    <span class="comment">// float a = 0.010;</span></span><br><span class="line">    <span class="comment">// float b = 0.01;</span></span><br><span class="line">    <span class="comment">// cout &lt;&lt; &amp;a &lt;&lt; endl;</span></span><br><span class="line">    <span class="comment">// cout &lt;&lt; &amp;b &lt;&lt; endl;</span></span><br><span class="line">    <span class="comment">// cout &lt;&lt; *(&amp;a) &lt;&lt; endl;</span></span><br><span class="line">    <span class="comment">// cout &lt;&lt; *(&amp;b) &lt;&lt; endl;</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">// test 3</span></span><br><span class="line">    <span class="keyword">float</span> N = <span class="number">132423000009977.0</span>;</span><br><span class="line">    <span class="keyword">float</span> a = <span class="number">1.0</span> / N / N / N / N / N / N / N / N / N / N / N / N / N / N / N / N / N / N / N / N * N * N * N * N * N * N * N * N * N * N * N * N * N * N * N * N * N * N * N * N * N;</span><br><span class="line">    <span class="keyword">float</span> b = <span class="number">1.0</span> / N / N / N / N / N / N / N / N / N / N / N / N / N / N / N / N / N / N / N;</span><br><span class="line">    <span class="keyword">float</span> c = b * N * N * N * N * N * N * N * N * N * N * N * N * N * N * N * N * N * N * N * N;</span><br><span class="line"></span><br><span class="line">    <span class="built_in">cout</span> &lt;&lt; <span class="string">"a: "</span> &lt;&lt; <span class="built_in">bitset</span>&lt;<span class="keyword">sizeof</span> a * 8&gt;(*(<span class="keyword">long</span> <span class="keyword">unsigned</span> <span class="keyword">int</span>*)(&amp;a)) &lt;&lt; <span class="string">" "</span> &lt;&lt; a &lt;&lt; endl;</span><br><span class="line">    <span class="built_in">cout</span> &lt;&lt; <span class="string">"b: "</span> &lt;&lt; <span class="built_in">bitset</span>&lt;<span class="keyword">sizeof</span> a * 8&gt;(*(<span class="keyword">long</span> <span class="keyword">unsigned</span> <span class="keyword">int</span>*)(&amp;b)) &lt;&lt; <span class="string">" "</span> &lt;&lt; b &lt;&lt; endl;</span><br><span class="line">    <span class="built_in">cout</span> &lt;&lt; <span class="string">"c: "</span> &lt;&lt; <span class="built_in">bitset</span>&lt;<span class="keyword">sizeof</span> a * 8&gt;(*(<span class="keyword">long</span> <span class="keyword">unsigned</span> <span class="keyword">int</span>*)(&amp;c)) &lt;&lt; <span class="string">" "</span> &lt;&lt; c &lt;&lt; endl;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>Result:</p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">a: <span class="number">01010110111100001110000001000100</span> <span class="number">1.32423e+14</span></span><br><span class="line">b: <span class="number">00000000000000000000000000000000</span> <span class="number">0</span></span><br><span class="line">c: <span class="number">00000000000000000000000000000000</span> <span class="number">0</span></span><br></pre></td></tr></table></figure>

      
    </div>
    
  </div>
  
    
<nav id="article-nav">
  
  
    <a href="/2017/08/22/using_mpi4py_on_windows/" id="article-nav-older" class="article-nav-link-wrap">
      <div class="article-nav-title">Using mpi4py</div>
      <strong class="article-nav-caption">></strong>
    </a>
  
</nav>

  
</article>






</div>
      <!-- footer id="footer">
  <div class="outer">
    <div id="footer-info">
    	<div class="footer-left">
    		&copy; 2017 Xi He
    	</div>
      	<div class="footer-right">
      		<a href="http://hexo.io/" target="_blank">Hexo</a>  Theme <a href="https://github.com/litten/hexo-theme-yilia" target="_blank">Yilia</a> by Litten
      	</div>
    </div>
  </div>
</footer> -->

<!-- <footer id="footer">
  
  <div class="outer">
    <div id="footer-info" class="inner">
      &copy; 2017 <a href="mailto:xih314@lehigh.edu" target="_blank"> Xi He </a>
          </div> 
  </div>
</footer>-->

<footer id="footer">
      <script async src="//dn-lbstatics.qbox.me/busuanzi/2.3/busuanzi.pure.mini.js"></script>
  
  <div class="outer">
    <div id="footer-info" class="inner">
      &copy; 2017 <a href="/more" target="_blank"> Xi He
          </div> 
  </div>
            <!-- <span id="busuanzi_container_site_uv">Total visitor <span id="busuanzi_value_site_uv"></span></span> -->   
            <!-- <span id="busuanzi_container_site_pv">Total page visits<span id="busuanzi_value_site_pv"></span></span> -->
</footer>
    </div>
    
  <link rel="stylesheet" href="/fancybox/jquery.fancybox.css" type="text/css">


<script>
	var yiliaConfig = {
		fancybox: true,
		mathjax: true,
		animate: true,
		isHome: false,
		isPost: true,
		isArchive: false,
		isTag: false,
		isCategory: false,
		open_in_new: false
	}
</script>
<script src="http://7.url.cn/edu/jslib/comb/require-2.1.6,jquery-1.9.1.min.js" type="text/javascript"></script>
<script src="/js/main.js" type="text/javascript"></script>


<script type="text/x-mathjax-config">
MathJax.Hub.Config({
    tex2jax: {
        inlineMath: [ ['$','$'], ["\\(","\\)"]  ],
        processEscapes: true,
        skipTags: ['script', 'noscript', 'style', 'textarea', 'pre', 'code']
    }
});

MathJax.Hub.Queue(function() {
    var all = MathJax.Hub.getAllJax(), i;
    for(i=0; i < all.length; i += 1) {
        all[i].SourceElement().parentNode.className += ' has-jax';                 
    }       
});
</script>

<script type="text/javascript" src="http://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML">
</script>


  </div>
</body>
</html>